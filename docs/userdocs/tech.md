# فن آوری

## معماری zkrollup ها

زی کی سینک یک پروتکل L2 بر اساس معماری جمع آوری ZK است. رول آپ ZK طعمی از خانواده بزرگتر "rollup" است. برای پیشینه بیشتر، راهنمای 2021 Vitalik Buterin را برای جمع‌آوری‌ها توصیه می‌کنیم.                            &#x20;

تمام وجوه توسط یک قرارداد هوشمند در زنجیره اصلی نگهداری می شود، در حالی که محاسبات و ذخیره سازی خارج از زنجیره انجام می شود. ایده اصلی این است که به جای تأیید هر تراکنش به طور جداگانه، تراکنش‌ها به یک آیتم واحد (بلوک جمع‌آوری) «قرار می‌شوند»، که سپس تأیید می‌شود و همه آنها به طور همزمان تأیید می‌شوند.                          &#x20;

به طور غیر رسمی، به شرح زیر عمل می کند:                                                                                                    &#x20;

1. کاربران تراکنش‌ها را امضا می‌کنند و آنها را به اعتبارسنجی‌ها ارسال می‌کنند.                                                 &#x20;
2. اعتباردهنده ها هزاران تراکنش را در یک بلوک جمع می کنند و یک تعهد رمزنگاری (هش ریشه) وضعیت جدید را به قرارداد هوشمند در شبکه اصلی همراه با یک مدرک رمزنگاری (SNARK) ارائه می کنند که این حالت جدید واقعاً نتیجه اعمال برخی از معاملات صحیح به حالت قدیمی.                                                                                    &#x20;
3. علاوه بر اثبات، حالت Δ (مقدار کمی از داده برای هر تراکنش) در شبکه اصلی به عنوان داده تماس ارزان منتشر می شود. این به هر کسی امکان می‌دهد که دولت را در هر لحظه بازسازی کند.                                              &#x20;
4. اثبات و حالت Δ توسط قرارداد هوشمند تأیید می شوند، بنابراین اعتبار همه تراکنش های موجود در بلوک و در دسترس بودن داده های بلوک را تأیید می کند.                                                                                         &#x20;

راستی‌آزمایی SNARK بسیار ارزان‌تر از تأیید هر تراکنش به‌صورت جداگانه است و ذخیره‌سازی حالت خارج از زنجیره به‌طور قابل‌توجهی ارزان‌تر از ذخیره آن در EVM است. از این رو افزایش قابل توجهی از مقیاس پذیری (\~100-200 برابر ظرفیت شبکه اصلی) و صرفه جویی در هزینه TX را ممکن می سازد.                                                                   &#x20;

معماری zkRollup تضمین های زیر را ارائه می دهد:                                                                                           &#x20;

* اعتبار سنجی ها هرگز نمی توانند دولت را فاسد کنند یا وجوه را بدزدند (برخلاف Sidechains).                         &#x20;
* کاربران همیشه می توانند وجوه قرارداد هوشمند zkRollup را بازیابی کنند، حتی اگر اعتباردهنده(های) همکاری خود را متوقف کنند، زیرا داده ها در دسترس هستند (برخلاف پلاسما).                                                    &#x20;
* نه کاربران و نه یک شخص ثالث مورد اعتماد نیازی به آنلاین بودن برای نظارت بر بلوک‌های zkRollup برای جلوگیری از تقلب ندارند (برخلاف سیستم‌های ضد تقلب، مانند کانال‌های پرداخت یا جمع‌بندی خوش‌بینانه).           &#x20;

به عبارت دیگر، zkRollup به شدت تضمین های امنیتی L1 زیربنایی را به ارث می برد.                                            &#x20;

در اینجا چند پیوند برای بررسی موضوع zkRollups وجود دارد:                                                                               &#x20;

* [Ethereum.org Zero-knowledge rollups](https://ethereum.org/en/developers/docs/scaling/layer-2-rollups/#zk-rollups)
* [Vitalik Buterin's guide to rollups (Jan 2021)](https://vitalik.ca/general/2021/01/05/rollup.html)
* [Original idea proposal by Buterin](https://ethresear.ch/t/on-chain-scaling-to-potentially-500-tx-sec-through-mass-tx-validation/3477)
* [Matter Labs' zkRollup talk at Zcon1 (video)](https://www.youtube.com/watch?v=QyM9qdFKsEA)
* [Awesome Zero-Knowledge Proofs materials](https://github.com/matter-labs/awesome-zero-knowledge-proofs)
* [zkRollup vs. Optimistic Rollup deep dive](https://medium.com/matter-labs/optimistic-vs-zk-rollup-deep-dive-ea141e71e075)
* [Validity proofs (zkRollup) vs. fraud proofs](https://medium.com/starkware/validity-proofs-vs-fraud-proofs-4ef8b4d3d87a)

## حداکثر توان عملیاتی

از زمان به‌روزرسانی در 9 فوریه 2021 که پشتیبانی از بازگشت به zkSync در شبکه اصلی را به همراه داشت، توان عملیاتی پروتکل اساساً به دلیل نیاز به انتشار تغییرات وضعیت برای هر تراکنش از طریق calldata اتریوم برای اطمینان از در دسترس بودن داده‌ها محدود می‌شود. با محدودیت فعلی گاز بلوک 12.5M، zkSync می تواند بیش از 2000 TPS را پردازش کند.                                                                                                                                &#x20;

## نهایی شدن معامله

تراکنش ها در zkSync زمانی که سند SNARK مربوط به بلوک zkSync ایجاد شده و توسط قرارداد هوشمند پذیرفته شود، به اتریوم نهایی می شود. انتظار می‌رود تولید زمان اثبات حدود 10 دقیقه باشد، یعنی 10 دقیقه پس از ارسال، تراکنش zkSync (اثبات) به اندازه هر تراکنش L1 Ethereum که در همان بلوک اتریوم موجود است به عنوان تراکنش با اثبات نهایی است. در حال حاضر، زمانی که کاربر تراکنشی را ارسال می کند، ما منتظر می مانیم تا بلوک پر شود و بنابراین فوراً اثبات را ایجاد نمی کنیم. با توان عملیاتی بالاتر در سیستم zkSync، زمان بین بلوک ها کاهش می یابد. &#x20;

در مقابل، راه‌حل‌های مقیاس‌بندی مبتنی بر تقلب (به‌عنوان مثال جمع‌بندی خوش‌بینانه) برای عملکرد کمابیش ایمن حداقل به ۲ هفته دوره قفل نیاز دارند که منجر به ۲ هفته زمان نهایی هدف \* tx می‌شود.                                     &#x20;

باید اضافه کرد که Matter Labs و سایر شرکت‌ها در فضای اثبات دانش صفر (ZKP) دائماً در حال کار بر روی بهبود کارایی پروور هستند که منجر به زمان‌های نهایی پایین‌تر (به طور بالقوه تا کمتر از 1 دقیقه) می‌شود.                         &#x20;



## تاییدیه های فوری

اگرچه زمان نهایی شدن حدود 10 دقیقه است، اما بر قابلیت استفاده شبکه تأثیری نمی گذارد. تراکنش‌های ارسال شده توسط کاربران به zkSync فوراً تأیید می‌شوند، فوراً به طرف دریافت‌کننده در رابط کاربری و API نمایش داده می‌شوند (اگرچه به‌عنوان تأییدنشده علامت‌گذاری شده‌اند)، و دارایی‌های منتقل‌شده را می‌توان بلافاصله برای انجام انتقال‌های بیشتر مورد استفاده قرار داد (که حتی ممکن است در نهایت در همان بلوک zkSync).                            &#x20;

در حال حاضر، تاییدیه‌های فوری وعده‌ای ناب از سوی اعتبارسنجی zkSync برای گنجاندن تراکنش در بلوک بعدی است. کاربرانی که به اعتبارسنجی اعتماد ندارند باید قبل از در نظر گرفتن دارایی ها به عنوان دریافت شده منتظر نهایی شدن کامل باشند.                                                                                                                                                    &#x20;

در آینده، یک باند امنیتی توسط اعتبار سنجی ها به zkSync اضافه خواهد شد. این تضمین نهایی اقتصادی فوری را فراهم می کند. به صورت زیر عمل خواهد کرد.                                                                                                &#x20;

اعتبارسنجی‌هایی که برای شرکت در تولید بلوک zkSync انتخاب می‌شوند، باید یک پیوند امنیتی قابل‌توجه به قرارداد هوشمند zkSync در شبکه اصلی ارسال کنند. اجماع اجرا شده توسط اعتبار سنجی، تأییدیه دومی را برای کاربر فراهم می کند که تراکنش او در بلوک zkSync بعدی، که توسط اکثریت فوق العاده (بیش از) ⅔ از شرکت کنندگان اجماع (با وزن سهام) امضا شده است، گنجانده می شود.                                                                                                  &#x20;

اگر یک بلوک zkSync جدید تولید و به زنجیره اصلی ارسال شود، نمی توان آن را برگرداند. اما اگر حاوی تراکنش های وعده داده شده نباشد، اوراق امنیتی تقاطع امضاکنندگان رسید اصلی و امضاکنندگان بلوک جدید کاهش می یابد. این تقاطع تضمین شده است که بیش از ⅓ سهام را داشته باشد. این تضمین می کند که حداقل از اوراق امنیتی را می توان کاهش داد و فقط اعتبار سنجی های مخرب مجازات خواهند شد.                                                                  &#x20;

بخشی از وجوه کاهش یافته برای جبران خسارت دریافت کننده tx استفاده می شود. بقیه سوخت خواهند شد.          &#x20;

## شبکه اصلی متراکم

به طور دوره‌ای، رویدادهای خارق‌العاده منجر به سطوح بسیار بالایی از تراکم در شبکه اتریوم می‌شود (نمونه‌های قابل توجه بحران Cryptokitties و حمله DOS شانگهای). در چنین زمان‌های اوج بار، قیمت بنزین سر به فلک می‌کشد و ممکن است جابه‌جایی دارایی‌های کریپتو بسیار گران شود و برخی از خدمات را غیرفعال کند یا از فرصت‌های آربیتراژ جلوگیری کند.                                                                                                                                              &#x20;

علاوه بر این، برخی از سیستم ها به طور کلی می توانند در شرایط شدید شکست بخورند که منجر به خرابی های آبشاری می شود (پنجشنبه سیاه اخیر DeFi یک مثال عالی است). این امر به ویژه برای راه‌حل‌های مقیاس‌بندی مبتنی بر تقلب (کانال‌های پرداخت، جمع‌آوری‌های خوش‌بینانه) نگران‌کننده است، زیرا این خطر وجود دارد که ربات‌های امنیتی خودکار آنها نتوانند تراکنش‌های ضد کلاهبرداری خود را در صورت حمله در طول بالا استخراج کنند. ازدحام، در نتیجه امنیت تمام دارایی های تحت کنترل چنین سیستم هایی را به خطر می اندازد. چه چیزی مشکل این سیستم ها را بدتر می کند، تا زمانی که این وضعیت رخ ندهد هرگز نمی توانید بفهمید (دقیقاً مانند آنچه برای ربات انحلال ساز میکر اتفاق افتاد).                                                                                                                                                            &#x20;

در مقابل، zkSync در موقعیت فوق‌العاده‌ای قرار دارد تا در یک محیط پر تراکم رشد کند.                                      &#x20;

اول از همه، یک شبکه شلوغ (درست مانند مورد حمله هدفمند DOS) هرگز نمی تواند هیچ تهدیدی برای دارایی ها در zkSync ایجاد کند. هرگونه جابه‌جایی وجوه در داخل یا خارج از zkSync نیاز به مدرکی با دانش صفر دارد و به هیچ وجه تحت تأثیر سانسور L1 قرار نمی‌گیرد.                                                                                                       &#x20;

ثانیاً، عملکرد عادی zkSync نیز بعید است که حتی برای مقادیر کمتر مختل شود. گره اعتبارسنجی طوری پیکربندی شده است که به طور خودکار قیمت گاز را به سطح بالاتر از حد متوسط ​​افزایش دهد تا بلوک‌های zkSync با اولویت بالا استخراج شوند. از آنجایی که هزینه هر تراکنش حدود 1/100 هزینه تراکنش ساده مربوطه در L1 است، کاربران zkSync کمترین تأثیر را خواهند داشت.                                                                                                         &#x20;
